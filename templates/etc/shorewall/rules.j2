#
# Shorewall version 4.0 - Sample Rules File for one-interface configuration.
# Copyright (C) 2006 by the Shorewall Team
#
# This library is free software; you can redistribute it and/or
# modify it under the terms of the GNU Lesser General Public
# License as published by the Free Software Foundation; either
# version 2.1 of the License, or (at your option) any later version.
#
# See the file README.txt for further details.
#------------------------------------------------------------------------------------------------------------
# For information on entries in this file, type "man shorewall-rules"
######################################################################################################################################################################################################
#ACTION		SOURCE		DEST		PROTO	DEST	SOURCE		ORIGINAL	RATE		USER/	MARK	CONNLIMIT	TIME		HEADERS		SWITCH		HELPER
#							PORT	PORT(S)		DEST		LIMIT		GROUP
{% for item in shorewall_rules %}
?SECTION {{ item.section }}
{%   if item.rules is defined %}
{%     for rule in item.rules %}
{{ rule.action }}   {% if rule.source is iterable and rule.source is not string %}{{ rule.source|join(',') }}{% else %}{{ rule.source }}{% endif %}
   {% if rule.dest is iterable and rule.dest is not string %}{{ rule.dest|join(',') }}{% else %}{{ rule.dest }}{% endif %}
   {% if rule.proto is iterable and rule.proto is not string %}{{ rule.proto|default('', true)|join(',') }}{% else %}{{ rule.proto }}{% endif %}
   {{ rule.dest_ports|default('', true)|join (',') }}
{%     endfor %}
{% endif %}
{% endfor %}
